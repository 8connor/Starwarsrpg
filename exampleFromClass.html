<html>
    <head>
        <title>Example page</title>
        <!-- Added link to the jQuery Library -->
        <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
        <!-- Added a link to Bootstrap-->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    </head>
    <body>
        <div class="container">
            <center>
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">
                Add Ingredient
                </button>
            </center>
            <table class="table">
            <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Ingredient</th>
                    <th scope="col"></th>
                    <th scope="col"></th>
                </tr>
            </thead>
            <tbody id="ingredients-list">
            </tbody>
            </table>
        <div class="modal" id="myModal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add new ingredient</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form>
                        <input type="text" name="add-ingredient-input" placeholder="Type ingredient here..." />
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button id="add-ingredient" type="button" class="btn btn-primary">Add Ingredient</button>
                </div>
                </div>
            </div>
            </div>
        </div>
        <script type="text/javascript">
        var cake = {
            flavor: "chocolate",
            toppings: ["drizzled fudge"],
            ingredients: [],
            candles: true, // does it have candles or not
            message: "",
            shape: "cirle", // or square or rectangle,
            correctOvenTemp: 350, // 350F
            correctTimerAmount: 35, // 35 minutes
            prepareCake: function() {
                this.toppings.push("sprinkles");
                this.toppings.push("strawberries");
                this.toppings.push("oreos", "nuts");
                this.addIngredientsToHTML();
                console.log("Cake toppings:");
                console.log(this.toppings);
                this.bakeCake()
            },
            addIngredientsToHTML: function() {
                // Example of correct implementation for a nested function to access "this.flavor" from object
                var somenewfunction = function(_flavor) {
                    console.log("Testing _flavor from a \"nested\" function!");
                    console.log(_flavor);
                }
                somenewfunction(this.flavor);
                // Example of bad implementation for a nested function to access this.flavor from object
                // THIS is not available in a nested function (2 layers of function() {} deep in an object)
                /*
                var somenewfunction = function() {
                    console.log("Tested this.flavor from a \"nested\" function");
                    console.log(this.flavor);
                }
                somenewfunction();
                */
                // Hook up to #ingredients-list "tbody" element in HTML
                var ingredientsListTable = $("#ingredients-list");
                // clear out table so when we re-run this function we do not add duplicate entries
                ingredientsListTable.html("");
                // Loop through all ingredients
                for(var i = 0; i < this.ingredients.length; i++) {
                    // Table row
                    var ingredientRow = $("<tr>");
                    ingredientRow.attr("data-row-ingredient-id", i);
                    // Table columns
                    var ingredientNumber = $("<td>");
                    // Set HTML of the # column to be the i + 1
                    ingredientNumber.html(i+1);
                    // Table column for ingredient text
                    var ingredientText = $("<td>");
                    // Set HTML of the ingredient column to be the value of the row we are in the array
                    ingredientText.html(this.ingredients[i]);
                    // Need to add the two new TDs to the TR we created
                    ingredientRow.append(ingredientNumber);
                    ingredientRow.append(ingredientText);
                    // Create delete TD, add button to delete TD HTML, append to ingredient Row to be added to page
                    var ingredientDeleteTD = $("<td>");
                    // create delete button and add classes
                    var deleteButton = $("<button>");
                    deleteButton.html("Delete");
                    deleteButton.data("ingredient", this.ingredients[i]);
                    deleteButton.attr("data-ingredient_id", i);
                    deleteButton.addClass("btn");
                    deleteButton.addClass("btn-danger");
                    deleteButton.on("click", function() {
                        console.log(this); // what is "this" going to be here?  cake?  or... BUTTON????
                        var currentIngredient = $(this).data("ingredient");
                        var areYouSure = confirm("Are you sure you want to delete " + currentIngredient);
                        if(areYouSure === true) {
                            //$("[data-row-ingredient-id=" + $(this).attr("data-ingredient_id") + "]").remove();
                            $(this).parent("td").parent("tr").remove();
                        }
                    });
                    // append delete button to ingredientDeleteTD
                    ingredientDeleteTD.append(deleteButton);
                    // append ingredientDeleteTD to ingredient row
                    ingredientRow.append(ingredientDeleteTD);
                    // append ingredient row to the real HTML element #ingredients-table
                    ingredientsListTable.append(ingredientRow);
                }
            },
            /* We need to bake the cake, heres an action
            for doing that */
            bakeCake: function() {
                var ovenTemp = this.correctOvenTemp;
                console.log("Put it in the oven! Temp: " + ovenTemp);
                var timer = this.correctTimerAmount; // 35 minutes
                console.log("Set timer for: " + timer);
                console.log("Baking....");
                console.log("Times up!");
                console.log("Take the cake out!");
            },
            /*getIngredientsFromUser: function(currentCount) {
                // I WANT TO HAVE USER DEFINE INGREDIENTS
                var ingredient = prompt("Give me an ingredient or TYPE 'N' TO EXIT.  You have added " + currentCount + " ingredients.");
                if(ingredient === "N") {
                    return false;
                } else {
                    this.ingredients.push(ingredient);
                    return true;
                }
            },
            runIngredientsLoop: function() {
                var shouldIKeepGoing = true;
                var count = 0;
                while(shouldIKeepGoing === true) {
                    console.log("Current count:"+count);
                    count++;
                    var shouldIKeepGoing = this.getIngredientsFromUser(count);
                }
            }*/
            // add a single ingredient to table
            addIngredient: function(_ingredient) {
                // push ingredient to ingredients list
                cake.ingredients.push(_ingredient);
                // re-render cake
                cake.prepareCake();
            }
        }
        $("#add-ingredient").on("click", function() {
            var ingredientInput = $("[name='add-ingredient-input']").val();
            cake.addIngredient(ingredientInput);
            $("[name='add-ingredient-input']").val("");
            alert("Ingredient added!");
            $("#myModal").modal("toggle");
        });
        //cake.runIngredientsLoop();
        //cake.prepareCake();
        $('#myModal').on('shown.bs.modal', function () {
            $('[name="add-ingredient-input"]').trigger('focus')
        })
        //philsFunction(philsVariable1);
        // y = mx+b
        // output = (1/2)10 + 5
        </script>
    </body>
</html>